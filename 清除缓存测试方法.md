# 清除缓存测试方法

## 🎯 问题分析

从最新日志发现所有公式都来自缓存：
```
[LaTeX Export] 批次缓存统计: 5 个缓存命中, 0 个需要转换
```

这意味着我们的修复可能没有真正生效，因为使用的是旧的缓存数据。

## 🔧 测试步骤

### 1. 完全清除缓存
在浏览器控制台中执行：
```javascript
// 清除LaTeX转换缓存
localStorage.clear();
sessionStorage.clear();

// 或者更直接地
location.reload(true); // 强制刷新
```

### 2. 使用新的测试公式
创建一个全新的测试文档，使用之前从未出现过的公式：

```markdown
# 全新公式测试

## 测试A（简单）
$$p + q = r$$

## 测试B（复杂）  
$$\frac{x + y}{z + w} = \frac{\frac{m}{n} + \frac{s}{t}}{\frac{u}{v} - \frac{a}{b}}$$

## 测试C（简单）
$$m \times n = o$$

## 测试D（复杂）
$$\sqrt{p^2 + q^2} = \sqrt[3]{\frac{x}{y}}$$

## 测试E（简单）
$$5 + 7 = 12$$
```

### 3. 监控关键日志

导出时重点观察：

1. **缓存统计**：
   ```
   [LaTeX Export] 批次缓存统计: X 个缓存命中, Y 个需要转换
   ```
   期望：`0 个缓存命中, 5 个需要转换`

2. **结果顺序验证**：
   ```
   [LaTeX Export] 结果顺序验证: ['1. formula_1', '2. formula_2', '3. formula_3', '4. formula_4', '5. formula_5']
   ```

3. **新的段落结构分析**：
   ```
   [OMML Post-process Debug] 段落 X: 标题 = "测试A（简单）"
   [OMML Post-process Debug] 段落 Y: 包含公式 1 = "p+q=r"
   [OMML Post-process Debug] 段落 Z: 标题 = "测试B（复杂）"  
   [OMML Post-process Debug] 段落 W: 包含公式 2 = "x+yz+w=..."
   ```

### 4. 验证Word文档

检查导出的Word文档中：
- 第一个公式应该是：p + q = r
- 第二个公式应该是：复杂分数
- 第三个公式应该是：m × n = o
- 第四个公式应该是：复杂根式
- 第五个公式应该是：5 + 7 = 12

## 📋 预期结果

如果修复成功：
- 缓存命中应该为0（全新公式）
- 段落结构分析应该显示正确的标题-公式配对
- Word文档中的公式顺序应该与Markdown一致

如果问题仍然存在：
- 我们需要进一步分析段落结构日志
- 可能需要在Word文档生成阶段添加更多调试信息
