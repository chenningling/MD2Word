# 全面公式测试文档

本文档用于测试MD到Word导出中各种公式场景，确保没有遗漏的问题。

## 1. 行内公式测试

### 1.1 基础行内公式
这是一个简单的行内公式 $E = mc^2$ 测试。

### 1.2 复杂行内公式
在物理学中，薛定谔方程为 $i\hbar\frac{\partial}{\partial t}\Psi(r,t) = \hat{H}\Psi(r,t)$，这是量子力学的基本方程。

### 1.3 多个行内公式
对于二次方程 $ax^2 + bx + c = 0$，解为 $x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}$。

### 1.4 行内公式与标点符号
计算圆的面积：$A = \pi r^2$；计算周长：$C = 2\pi r$。

### 1.5 行内公式在句子开头
$\sin^2 x + \cos^2 x = 1$ 是基本的三角恒等式。

### 1.6 行内公式在句子结尾
牛顿第二定律表述为 $F = ma$。

## 2. 独立公式测试

### 2.1 简单独立公式

$$E = mc^2$$

### 2.2 复杂分数公式

$$x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}$$

### 2.3 矩阵公式

$$\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}$$

### 2.4 求和公式

$$\sum_{i=1}^{n} i = \frac{n(n+1)}{2}$$

### 2.5 积分公式

$$\int_{0}^{\infty} e^{-x^2} dx = \frac{\sqrt{\pi}}{2}$$

### 2.6 极限公式

$$\lim_{x \to 0} \frac{\sin x}{x} = 1$$

## 3. 混合场景测试

### 3.1 连续行内公式
化学反应中，$2H_2 + O_2 \rightarrow 2H_2O$ 是氢气燃烧的方程，其中 $\Delta H = -286 \text{ kJ/mol}$。

### 3.2 行内公式 + 独立公式
爱因斯坦质能方程 $E = mc^2$ 可以展开为：

$$E^2 = (pc)^2 + (mc^2)^2$$

其中 $p$ 是动量，$c$ 是光速。

### 3.3 多个独立公式
麦克斯韦方程组：

$$\nabla \cdot \mathbf{E} = \frac{\rho}{\epsilon_0}$$

$$\nabla \cdot \mathbf{B} = 0$$

$$\nabla \times \mathbf{E} = -\frac{\partial \mathbf{B}}{\partial t}$$

$$\nabla \times \mathbf{B} = \mu_0\mathbf{J} + \mu_0\epsilon_0\frac{\partial \mathbf{E}}{\partial t}$$

## 4. 边缘情况测试

### 4.1 紧邻文本的行内公式
不要这样写$x=1$没有空格，应该这样写 $x = 1$ 有空格。

### 4.2 包含特殊字符的公式
生成函数：$G(x) = \sum_{n=0}^{\infty} a_n x^n = \frac{1}{1-x}$ (当 $|x| < 1$)。

### 4.3 希腊字母公式
统计学中，$\mu$ 表示均值，$\sigma$ 表示标准差，$\sigma^2$ 表示方差。

### 4.4 上下标嵌套
复杂的化学式：$Ca_{10}(PO_4)_6(OH)_2$ 和 $H_2SO_4$。

### 4.5 根号和分数嵌套

$$\sqrt{\frac{a^2 + b^2}{c^2 + d^2}}$$

### 4.6 长公式
高阶导数：

$$\frac{d^n}{dx^n}[f(x)g(x)] = \sum_{k=0}^{n} \binom{n}{k} f^{(k)}(x) g^{(n-k)}(x)$$

## 5. 格式化测试

### 5.1 公式与列表

计算以下数值：
- 第一项：$a_1 = 2$
- 第二项：$a_2 = 4$ 
- 第三项：$a_3 = 6$

总和为：$S = a_1 + a_2 + a_3 = 12$

### 5.2 公式与表格

| 函数 | 导数 | 积分 |
|------|------|------|
| $x^n$ | $nx^{n-1}$ | $\frac{x^{n+1}}{n+1} + C$ |
| $e^x$ | $e^x$ | $e^x + C$ |
| $\sin x$ | $\cos x$ | $-\cos x + C$ |

### 5.3 引用中的公式
> 如欧拉所说："$e^{i\pi} + 1 = 0$ 是数学中最美丽的等式。"

## 6. 错误处理测试

### 6.1 不匹配的美元符号
这里有一个不匹配的符号 $ 但是没有结束。

正常的公式应该这样：$x + y = z$。

### 6.2 空公式
这是一个空公式：$$$$

这是另一个空公式：$ $。

### 6.3 特殊字符处理
包含美元符号的文本：商品价格是$100，打折后是$80。

但是数学公式：$price = 100 - 20 = 80$。

## 7. 性能测试

### 7.1 大量公式
这是一个包含很多公式的段落：$a_1$, $a_2$, $a_3$, $a_4$, $a_5$, $a_6$, $a_7$, $a_8$, $a_9$, $a_{10}$, $a_{11}$, $a_{12}$, $a_{13}$, $a_{14}$, $a_{15}$。

### 7.2 长段落中的公式
在这个很长很长很长很长很长很长很长很长很长很长很长很长很长很长很长很长的段落中，我们插入一个公式 $\int_0^1 x^2 dx = \frac{1}{3}$，然后继续很长很长很长很长很长很长很长很长很长很长很长很长很长很长很长很长的文本。

## 测试总结

以上测试涵盖了：
- ✅ 基础行内公式
- ✅ 复杂行内公式  
- ✅ 独立块公式
- ✅ 混合场景
- ✅ 边缘情况
- ✅ 格式化场景
- ✅ 错误处理
- ✅ 性能场景

请确保所有场景都能正确导出到Word文档。
