# MD2Word 项目实施计划

## 项目概述
- **项目名称**：Word快速排版助手——MD2Word
- **功能简介**：用户输入markdown文本内容，设置word格式排版，导出精确排版的word文档
- **核心目标**：确保Word文档生成的精确性，严格按照用户设置的排版样式显示

## 技术栈选择
- **前端框架**：React.js
- **UI库**：Ant Design
- **Markdown编辑器**：@uiw/react-codemirror
- **Word文档生成**：docx.js
- **本地存储**：localStorage
- **样式处理**：styled-components

## 项目结构设计
```
src/
├── components/           # 组件
│   ├── Header/           # 顶部导航
│   ├── MarkdownEditor/   # Markdown编辑器
│   ├── WordPreview/      # Word预览区
│   ├── FormatSettings/   # 排版设置面板
│   ├── Resizer/          # 可调整宽度的分割线
│   └── Sidebar/          # 左侧工具栏
├── contexts/             # React上下文
│   └── DocumentContext/  # 文档内容与格式上下文
├── services/             # 服务
│   ├── exportService.js  # 导出服务
│   └── storageService.js # 本地存储服务
├── utils/                # 工具函数
├── styles/               # 全局样式
└── App.js                # 应用入口
```

## 开发阶段规划

### 阶段一：基础框架搭建（1-2天）
- [x] 项目初始化
- [x] React项目创建与配置
- [x] 安装必要依赖
- [x] 基本组件结构搭建
- [x] 实现基础布局

### 阶段二：核心功能开发（3-5天）
- [x] Markdown编辑器实现
  - [x] 集成CodeMirror
  - [x] 基本编辑功能
  - [x] 语法高亮
  - [x] 自动换行功能
- [x] 本地存储功能
  - [x] 自动保存编辑内容
  - [x] 恢复上次编辑状态
- [x] 基础预览功能
  - [x] Markdown到HTML转换
  - [x] 基础样式应用
- [x] 简单排版设置
  - [x] 字体设置
  - [x] 字号设置
  - [x] 行间距设置

### 阶段三：Word导出功能（2-3天）
- [x] docx.js集成
- [x] 基础格式转换实现
  - [x] 标题转换
  - [x] 段落转换
  - [x] 列表转换
  - [x] 表格转换
  - [x] 代码块转换
  - [x] 水平线转换
  - [x] 删除线转换
  - [x] 链接转换
- [x] 导出功能实现
  - [x] 生成.docx文件
  - [x] 文件下载功能
- [ ] 高级格式支持
  - [ ] 图片嵌入
  - [x] Mermaid流程图

### 阶段四：排版格式设置完善（2-3天）
- [x] 预设模板实现
  - [x] 研究论文模板
  - [x] 法律文书模板
  - [x] 公司公文模板
- [x] 自定义排版设置
  - [x] 元素类型设置（标题、正文等）
  - [x] 页面布局设置
- [x] 模板保存功能
  - [x] 保存自定义模板
  - [x] 编辑/删除模板

### 阶段五：左侧工具栏功能（1-2天）
- [x] Markdown语法学习模块
  - [x] 基础语法展示
  - [x] 示例代码与效果对照
- [x] 文本转Markdown功能
  - [x] 多行文本输入框
  - [x] AI平台转换按钮
  - [x] 提示词自动复制
  - [x] 转换步骤指引
- [x] 界面优化
  - [x] 响应式布局调整
  - [x] 交互优化
  - [x] 可调整编辑器与预览区域宽度比例

### 阶段六：测试与优化（2-3天）
- [ ] 功能测试
  - [ ] 编辑功能测试
  - [ ] 导出功能测试
  - [ ] 排版设置测试
  - [ ] 文本转Markdown功能测试
- [ ] 性能优化
  - [ ] 大文档处理优化
  - [ ] 渲染性能优化
- [ ] 兼容性测试
  - [ ] 跨浏览器测试
  - [ ] 不同设备测试

## 关键技术点实现方案

### Markdown编辑与预览
- 使用@uiw/react-codemirror实现编辑器
- 实时解析Markdown为HTML
- 应用自定义CSS样式模拟Word效果
- 启用自动换行功能，提升编辑体验

### 排版设置
- 使用React Context管理全局排版设置
- 预设模板存储为JSON配置
- 用户自定义设置也保存为JSON

### Word导出
- 使用docx.js将内容转换为.docx格式
- 根据排版设置应用相应的Word样式
- 提供下载功能
- 支持多种Markdown格式元素的转换：
  - 标题、段落、列表、表格
  - 代码块、水平线、删除线
  - 链接、粗体、斜体

### 文本转Markdown功能
- 提供多行文本输入框供用户粘贴原始文本
- 集成主流AI平台（DeepSeek、Kimi、通义千问）的一键跳转
- 自动构建并复制提示词到剪贴板
- 提供转换步骤引导，帮助用户完成转换流程

### 本地存储
- 使用localStorage存储文档内容
- 使用localStorage存储用户自定义模板
- 使用localStorage存储界面布局设置
- 实现自动保存功能

### 用户界面
- 响应式布局设计
- 可调整的分割线，自定义编辑区与预览区比例
- 保存用户界面布局偏好

## 风险评估与应对策略

### 技术风险
- **Word格式精确控制难度**
  - 应对：深入研究docx.js API，进行充分测试
- **预览与实际效果不一致**
  - 应对：开发专用的预览样式，尽可能模拟Word效果
- **复杂Markdown元素转换难度**
  - 应对：分阶段实现，先支持基础元素，再逐步添加复杂元素支持

### 项目风险
- **功能过于复杂导致开发延期**
  - 应对：优先实现核心功能，其他功能迭代开发
- **用户体验不佳**
  - 应对：定期进行用户测试，收集反馈

## 项目进度跟踪
| 阶段 | 计划时间 | 实际时间 | 完成状态 | 备注 |
|------|----------|----------|----------|------|
| 阶段一 | 1-2天 | 1天 | 已完成 | 基础框架搭建完成 |
| 阶段二 | 3-5天 | - | 已完成 | 已完成基础功能，增加自动换行功能 |
| 阶段三 | 2-3天 | 2天 | 部分完成 | 已实现Word导出功能，增加多种格式支持 |
| 阶段四 | 2-3天 | - | 已完成 | 已完成排版设置和模板功能 |
| 阶段五 | 1-2天 | - | 已完成 | 工具栏功能已实现，增加可调整宽度功能和文本转MD功能 |
| 阶段六 | 2-3天 | - | 未开始 | - |

## 下一步计划
1. 准备AI平台logo图片，放置在public/images目录下
2. 进行文本转Markdown功能测试，确保功能正常工作
3. 实现图片嵌入支持
4. 优化用户界面和交互体验
5. 进行兼容性测试，确保在不同浏览器和设备上正常工作

## 最近更新
- **2023-xx-xx**: 实现了文本转Markdown功能，支持一键跳转到多个AI平台进行转换 